<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>它山堰知识图谱</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    #chart {
      width: 80%;
      height: 600px;
      margin: 0 auto;
    }
    #info-panel {
      width: 80%;
      height: 100px;
      margin: 10px auto;
      border: 1px solid #ccc;
      padding: 10px;
      display: none;
    }
  </style>
</head>
<body>
  <h1 style="text-align: center;">它山堰知识图谱</h1>
  <div id="chart"></div>
  <div id="info-panel"></div>
  <script>
    var chartDom = document.getElementById('chart');
    var myChart = echarts.init(chartDom);
    var option;

    var nodes = [
      { name: '它山堰', category: 0 },
      { name: '地理位置', category: 1 },
      { name: '基础信息', category: 1 },
      { name: '结构组成', category: 1 },
      { name: '历史沿革', category: 1 },
      { name: '工程特点', category: 1 },
      { name: '具体坐标', category: 2 },
      { name: 'AD833', category: 2 },
      { name: '解决水患', category: 2 },
      { name: '阻咸蓄淡', category: 2 },
      { name: '拦河坝', category: 2 },
      { name: '分水系统', category: 2 },
      { name: '附属设施', category: 2 },
      { name: '配套工程', category: 2 },
      { name: '唐代始建', category: 2 },
      { name: '宋代修建', category: 2 },
      { name: '明清改造', category: 2 },
      { name: '四大工程', category: 2 },
      { name: '科学设计', category: 2 },
      { name: '技术成就', category: 2 }
    ];

    var links = [
      { source: '它山堰', target: '地理位置', label: '位于' },
      { source: '它山堰', target: '基础信息', label: '具备' },
      { source: '它山堰', target: '结构组成', label: '包含' },
      { source: '它山堰', target: '历史沿革', label: '历经' },
      { source: '它山堰', target: '工程特点', label: '拥有' },
      { source: '地理位置', target: '具体坐标', label: '坐标为' },
      { source: '基础信息', target: 'AD833', label: '建造于' },
      { source: '基础信息', target: '解决水患', label: '建造目的' },
      { source: '基础信息', target: '阻咸蓄淡', label: '主要功能' },
      { source: '结构组成', target: '拦河坝', label: '主体是' },
      { source: '结构组成', target: '分水系统', label: '包含' },
      { source: '结构组成', target: '附属设施', label: '包含' },
      { source: '结构组成', target: '配套工程', label: '包含' },
      { source: '历史沿革', target: '唐代始建', label: '始建于' },
      { source: '历史沿革', target: '宋代修建', label: '宋代有' },
      { source: '历史沿革', target: '明清改造', label: '明清进行' },
      { source: '工程特点', target: '四大工程', label: '地位体现' },
      { source: '工程特点', target: '科学设计', label: '设计特色' },
      { source: '工程特点', target: '技术成就', label: '技术成果' }
    ];

    function getNodeInfo(name) {
      var info = '';
      switch(name) {
        case '具体坐标':
          info = '经度121.352615，纬度29.767303。';
          break;
        case 'AD833':
          info = '唐太和七年（公元833年）由县令王元暐主持建造。';
          break;
        case '解决水患':
          info = '为解决海水倒灌、农田卤化、城市用水困难而建。';
          break;
        case '阻咸蓄淡':
          info = '能阻咸蓄淡，灌溉鄞西平原农田，供宁波城用水。';
          break;
        case '拦河坝':
          info = '条石砌筑，全长134.4米，高3.05米，宽4.8米，坝体中空。';
          break;
        case '分水系统':
          info = '涝时七分入江、三分入溪，旱时七分入溪、三分入江。';
          break;
        case '附属设施':
          info = '包括乌金碶等，还有回沙闸、洪水湾塘等。';
          break;
        case '配套工程':
          info = '清末民初有九坝、五堰、十三塘，建国后进行整治。';
          break;
        case '唐代始建':
          info = '833年县令王元暐主持建造，建庙纪念，旁建小庙纪念“十兄弟”。';
          break;
        case '宋代修建':
          info = '约1068年建风棚碶，1242年建回沙闸，1255年左右置三坝。';
          break;
        case '明清改造':
          info = '明代嘉靖十五年加高堰顶，清代咸丰七年也有相关举措（文档未详细提及）。';
          break;
        case '四大工程':
          info = '与都江堰、郑国渠、灵渠并称“中国四大古代水利工程”。';
          break;
        case '科学设计':
          info = '有倾斜坝基、鼓形平面、中央加厚等科学设计。';
          break;
        case '技术成就':
          info = '是我国首次出现的块石砌筑重力型拦河滚水坝，提高坝体稳定性。';
          break;
        case '它山堰':
          info = '是著名古代水利工程，位于特定地理位置，有重要作用。';
          break;
        case '地理位置':
          info = '它山堰所处的经纬度位置信息。';
          break;
        case '基础信息':
          info = '涵盖建造时间、背景、功能等基本信息。';
          break;
        case '结构组成':
          info = '包含主体、分水、附属和配套工程等结构。';
          break;
        case '历史沿革':
          info = '历经唐、宋、明清等时期的建造和改造。';
          break;
        case '工程特点':
          info = '具有重要历史地位和科学设计、技术成就。';
          break;
      }
      return info;
    }

    option = {
      tooltip: {
        trigger: 'item',
        formatter: function(params) {
          if (params.dataType === 'edge') {
            return params.data.label;
          }
          return params.data.name + '<br/>' + getNodeInfo(params.data.name);
        }
      },
      series: [
        {
          type: 'graph',
          layout: 'force',
          data: nodes,
          links: links,
          categories: [
            { name: '中心节点' },
            { name: '一级节点' },
            { name: '二级节点' }
          ],
          roam: true,
          label: {
            show: true,
            position: 'inside'
          },
          force: {
            initLayout: 'circular',
            repulsion: 2000,
            edgeLength: [50, 100],
            gravity: 0.5
          },
          lineStyle: {
            color: 'source',
            curveness: 0.3
          },
          symbolSize: 65,
          edgeLabel: {
            show: true,
            formatter: function (params) {
              return params.data.label;
            }
          }
        }
      ]
    };

    myChart.setOption(option);

    myChart.on('mouseover', function(params) {
      if (params.dataType === 'node') {
        var infoPanel = document.getElementById('info-panel');
        infoPanel.innerHTML = params.data.name + '<br/>' + getNodeInfo(params.data.name);
        infoPanel.style.display = 'block';
      }
    });

    myChart.on('mouseout', function() {
      var infoPanel = document.getElementById('info-panel');
      infoPanel.style.display = 'none';
    });
  </script>
</body>
</html>